\doxysection{Custom\+Data\+Generator Class Reference}
\hypertarget{classgenerator_1_1CustomDataGenerator}{}\label{classgenerator_1_1CustomDataGenerator}\index{CustomDataGenerator@{CustomDataGenerator}}


Inherits Sequence.

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_afd7d253a4f8941e64a51a7767cb14df3}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, \mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a97f6ff904dffadf30914530207aba963}{data\+\_\+directory}}, \mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_ab7a18b2ff11484217c4b8c7779120bf9}{batch\+\_\+size}}, \mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a865514e30baa11b11c8fa65f944532fb}{input\+\_\+shape}}, \mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_aa585887179567b593fe146fe17fc551b}{stop\+\_\+training\+\_\+flag}}=\{"{}stop"{}\+:\+False\}, \mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_ad2880fbf0312c260df976f09d49405f2}{shuffle}}=True)
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a80018a6c27f74b5038f32e0343969f50}{load\+\_\+image\+\_\+and\+\_\+label\+\_\+paths}} (self)
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a6781b036ba1c606be31ad87a0d530414}{\+\_\+\+\_\+len\+\_\+\+\_\+}} (self)
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a21daf423bea73313685ea12e2fa08298}{read\+\_\+img}} (self, path)
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a4a3d091289c5d4a7ed11e07ab4886155}{\+\_\+\+\_\+getitem\+\_\+\+\_\+}} (self, index)
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a3fc6af0e2f06495a4e5764bc1571cd5d}{read\+\_\+binary\+\_\+label}} (self, label\+\_\+path)
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_aeba7102259ae5a74f49934589abb6feb}{on\+\_\+epoch\+\_\+end}} (self)
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a97f6ff904dffadf30914530207aba963}{data\+\_\+directory}} = data\+\_\+directory
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_ab7a18b2ff11484217c4b8c7779120bf9}{batch\+\_\+size}} = batch\+\_\+size
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a865514e30baa11b11c8fa65f944532fb}{input\+\_\+shape}} = input\+\_\+shape\mbox{[}\+:2\mbox{]}
\item 
int \mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_ae3542d396ed395e696eb8c9af9f6121b}{nr\+\_\+channels}} = \mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a865514e30baa11b11c8fa65f944532fb}{input\+\_\+shape}}\mbox{[}2\mbox{]}
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_ad2880fbf0312c260df976f09d49405f2}{shuffle}} = shuffle
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_aa585887179567b593fe146fe17fc551b}{stop\+\_\+training\+\_\+flag}} = stop\+\_\+training\+\_\+flag
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_ad42a5b89fb50f978fbfe983f0d74c2b5}{image\+\_\+paths}}
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_af32efc5fd3427b2cf3071bc9777a7785}{label\+\_\+paths}} = self.\+load\+\_\+image\+\_\+and\+\_\+label\+\_\+paths()
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a499783d60b6c70b059e758c48d3c4864}{indexes}} = np.\+arange(len(self.\+image\+\_\+paths))
\item 
\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a8d1684aa4cf516e3febdcb64d835fd92}{augmenter}} = \mbox{\hyperlink{namespacegenerator_afe40eb398e35b9d89acf3fe4fdd2f878}{get\+\_\+augmenter}}(\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a865514e30baa11b11c8fa65f944532fb}{input\+\_\+shape}}\mbox{[}\+:2\mbox{]})
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Custom data generator for Keras models.

This generator deals with YOLO-format object detection data annotations and loads them into a Keras Sequence suitable for training binary (presence/absence) mobilenet_v2 models. 
This is done by: 1) loading images and their corresponding labels, 2) resizing them to fit model input shape, 3) application of pre-processing and image augmentation.
Preprocessing is facilitated by the mobilenet_v2 preprocess_input function, accessed through Keras and augmentation makes use of the imgaug PyPI package.
If the input shape contains only 1 colour channel, then preprocessing loads the images as greyscale using opencv function cvtColor.
Each Generator yields batches for training or evaluation, batch size is selected at instantation. 

CustomDataGenerator is iterable, the method __get_item__() can be broken out for debugging purposes by setting the stop_training_flag.

Attributes:
    data_directory (str or list): Directory or list of directories containing images and labels.
    batch_size (int): Number of samples per batch.
    input_shape (tuple): Shape of the input images (height, width, channels).
    stop_training_flag (dict): Dictionary containing a 'stop' flag for early stopping.
    shuffle (bool): Whether to shuffle the dataset at the end of each epoch.
\end{DoxyVerb}
 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classgenerator_1_1CustomDataGenerator_afd7d253a4f8941e64a51a7767cb14df3}\index{CustomDataGenerator@{CustomDataGenerator}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_afd7d253a4f8941e64a51a7767cb14df3} 
\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{data\+\_\+directory}{, }\item[{}]{batch\+\_\+size}{, }\item[{}]{input\+\_\+shape}{, }\item[{}]{stop\+\_\+training\+\_\+flag}{ = {\ttfamily \{"{}stop"{}\+:False\}}, }\item[{}]{shuffle}{ = {\ttfamily True}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Initialize the data generator.

Args:
    data_directory (str or list): Directory or list of directories with image and label files.
    batch_size (int): Number of samples per batch.
    input_shape (tuple): Shape of the input images (height, width, channels).
    stop_training_flag (dict): Dictionary with a 'stop' key to signal early stopping, a useful way to stop the generator hanging for test runs.
    shuffle (bool): Whether to shuffle data after each epoch. Defaults to True.
\end{DoxyVerb}
 

\doxysubsection{Member Function Documentation}
\Hypertarget{classgenerator_1_1CustomDataGenerator_a4a3d091289c5d4a7ed11e07ab4886155}\index{CustomDataGenerator@{CustomDataGenerator}!\_\_getitem\_\_@{\_\_getitem\_\_}}
\index{\_\_getitem\_\_@{\_\_getitem\_\_}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{\_\_getitem\_\_()}{\_\_getitem\_\_()}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_a4a3d091289c5d4a7ed11e07ab4886155} 
\+\_\+\+\_\+getitem\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{index}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Generate one batch of data. This method will raise a StopIteration Exception if self.stop_training_flag is set.

Args:
    index (int): Index of the batch.

Returns:
    tuple: Batch of images (X) and labels (y).
\end{DoxyVerb}
 \Hypertarget{classgenerator_1_1CustomDataGenerator_a6781b036ba1c606be31ad87a0d530414}\index{CustomDataGenerator@{CustomDataGenerator}!\_\_len\_\_@{\_\_len\_\_}}
\index{\_\_len\_\_@{\_\_len\_\_}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{\_\_len\_\_()}{\_\_len\_\_()}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_a6781b036ba1c606be31ad87a0d530414} 
\+\_\+\+\_\+len\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Compute the number of batches per epoch.

Returns:
    int: Number of batches.
\end{DoxyVerb}
 \Hypertarget{classgenerator_1_1CustomDataGenerator_a80018a6c27f74b5038f32e0343969f50}\index{CustomDataGenerator@{CustomDataGenerator}!load\_image\_and\_label\_paths@{load\_image\_and\_label\_paths}}
\index{load\_image\_and\_label\_paths@{load\_image\_and\_label\_paths}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{load\_image\_and\_label\_paths()}{load\_image\_and\_label\_paths()}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_a80018a6c27f74b5038f32e0343969f50} 
load\+\_\+image\+\_\+and\+\_\+label\+\_\+paths (\begin{DoxyParamCaption}\item[{}]{self}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Load paths to image and label files.

Returns:
    tuple: Lists of image paths and corresponding label paths.
\end{DoxyVerb}
 \Hypertarget{classgenerator_1_1CustomDataGenerator_aeba7102259ae5a74f49934589abb6feb}\index{CustomDataGenerator@{CustomDataGenerator}!on\_epoch\_end@{on\_epoch\_end}}
\index{on\_epoch\_end@{on\_epoch\_end}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{on\_epoch\_end()}{on\_epoch\_end()}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_aeba7102259ae5a74f49934589abb6feb} 
on\+\_\+epoch\+\_\+end (\begin{DoxyParamCaption}\item[{}]{self}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Shuffle the dataset at the end of each epoch, if enabled.
\end{DoxyVerb}
 \Hypertarget{classgenerator_1_1CustomDataGenerator_a3fc6af0e2f06495a4e5764bc1571cd5d}\index{CustomDataGenerator@{CustomDataGenerator}!read\_binary\_label@{read\_binary\_label}}
\index{read\_binary\_label@{read\_binary\_label}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{read\_binary\_label()}{read\_binary\_label()}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_a3fc6af0e2f06495a4e5764bc1571cd5d} 
read\+\_\+binary\+\_\+label (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{label\+\_\+path}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Read a binary label from a label file.

Args:
    label_path (str): Path to the label file.

Returns:
    float: Binary label (1.0 for presence, 0.0 for absence).
\end{DoxyVerb}
 \Hypertarget{classgenerator_1_1CustomDataGenerator_a21daf423bea73313685ea12e2fa08298}\index{CustomDataGenerator@{CustomDataGenerator}!read\_img@{read\_img}}
\index{read\_img@{read\_img}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{read\_img()}{read\_img()}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_a21daf423bea73313685ea12e2fa08298} 
read\+\_\+img (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{path}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Read and preprocess an image.

Args:
    path (str): Path to the image file.

Returns:
    np.ndarray: Preprocessed image.
\end{DoxyVerb}
 

\doxysubsection{Member Data Documentation}
\Hypertarget{classgenerator_1_1CustomDataGenerator_a8d1684aa4cf516e3febdcb64d835fd92}\index{CustomDataGenerator@{CustomDataGenerator}!augmenter@{augmenter}}
\index{augmenter@{augmenter}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{augmenter}{augmenter}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_a8d1684aa4cf516e3febdcb64d835fd92} 
augmenter = \mbox{\hyperlink{namespacegenerator_afe40eb398e35b9d89acf3fe4fdd2f878}{get\+\_\+augmenter}}(\mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a865514e30baa11b11c8fa65f944532fb}{input\+\_\+shape}}\mbox{[}\+:2\mbox{]})}

\Hypertarget{classgenerator_1_1CustomDataGenerator_ab7a18b2ff11484217c4b8c7779120bf9}\index{CustomDataGenerator@{CustomDataGenerator}!batch\_size@{batch\_size}}
\index{batch\_size@{batch\_size}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{batch\_size}{batch\_size}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_ab7a18b2ff11484217c4b8c7779120bf9} 
batch\+\_\+size = batch\+\_\+size}

\Hypertarget{classgenerator_1_1CustomDataGenerator_a97f6ff904dffadf30914530207aba963}\index{CustomDataGenerator@{CustomDataGenerator}!data\_directory@{data\_directory}}
\index{data\_directory@{data\_directory}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{data\_directory}{data\_directory}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_a97f6ff904dffadf30914530207aba963} 
data\+\_\+directory = data\+\_\+directory}

\Hypertarget{classgenerator_1_1CustomDataGenerator_ad42a5b89fb50f978fbfe983f0d74c2b5}\index{CustomDataGenerator@{CustomDataGenerator}!image\_paths@{image\_paths}}
\index{image\_paths@{image\_paths}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{image\_paths}{image\_paths}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_ad42a5b89fb50f978fbfe983f0d74c2b5} 
image\+\_\+paths}

\Hypertarget{classgenerator_1_1CustomDataGenerator_a499783d60b6c70b059e758c48d3c4864}\index{CustomDataGenerator@{CustomDataGenerator}!indexes@{indexes}}
\index{indexes@{indexes}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{indexes}{indexes}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_a499783d60b6c70b059e758c48d3c4864} 
indexes = np.\+arange(len(self.\+image\+\_\+paths))}

\Hypertarget{classgenerator_1_1CustomDataGenerator_a865514e30baa11b11c8fa65f944532fb}\index{CustomDataGenerator@{CustomDataGenerator}!input\_shape@{input\_shape}}
\index{input\_shape@{input\_shape}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{input\_shape}{input\_shape}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_a865514e30baa11b11c8fa65f944532fb} 
input\+\_\+shape = input\+\_\+shape\mbox{[}\+:2\mbox{]}}

\Hypertarget{classgenerator_1_1CustomDataGenerator_af32efc5fd3427b2cf3071bc9777a7785}\index{CustomDataGenerator@{CustomDataGenerator}!label\_paths@{label\_paths}}
\index{label\_paths@{label\_paths}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{label\_paths}{label\_paths}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_af32efc5fd3427b2cf3071bc9777a7785} 
label\+\_\+paths = self.\+load\+\_\+image\+\_\+and\+\_\+label\+\_\+paths()}

\Hypertarget{classgenerator_1_1CustomDataGenerator_ae3542d396ed395e696eb8c9af9f6121b}\index{CustomDataGenerator@{CustomDataGenerator}!nr\_channels@{nr\_channels}}
\index{nr\_channels@{nr\_channels}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{nr\_channels}{nr\_channels}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_ae3542d396ed395e696eb8c9af9f6121b} 
int nr\+\_\+channels = \mbox{\hyperlink{classgenerator_1_1CustomDataGenerator_a865514e30baa11b11c8fa65f944532fb}{input\+\_\+shape}}\mbox{[}2\mbox{]}}

\Hypertarget{classgenerator_1_1CustomDataGenerator_ad2880fbf0312c260df976f09d49405f2}\index{CustomDataGenerator@{CustomDataGenerator}!shuffle@{shuffle}}
\index{shuffle@{shuffle}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{shuffle}{shuffle}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_ad2880fbf0312c260df976f09d49405f2} 
shuffle = shuffle}

\Hypertarget{classgenerator_1_1CustomDataGenerator_aa585887179567b593fe146fe17fc551b}\index{CustomDataGenerator@{CustomDataGenerator}!stop\_training\_flag@{stop\_training\_flag}}
\index{stop\_training\_flag@{stop\_training\_flag}!CustomDataGenerator@{CustomDataGenerator}}
\doxysubsubsection{\texorpdfstring{stop\_training\_flag}{stop\_training\_flag}}
{\footnotesize\ttfamily \label{classgenerator_1_1CustomDataGenerator_aa585887179567b593fe146fe17fc551b} 
stop\+\_\+training\+\_\+flag = stop\+\_\+training\+\_\+flag}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
generator.\+py\end{DoxyCompactItemize}
